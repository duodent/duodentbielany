{% extends 'base.html' %}
{% block content %}

<!-- page banner -->
{% set bg_image_treatments_details = url_for('static', filename='img/banners/zabieg-4-banner.jpg') %}
<div class="page-banner-area mb-5" id="pageBanner" style="background-image: url('{{ bg_image_treatments_details }}');">
    <div class="container">
        <div class="page-banner-content">
            <div class="page-banner-content">
                <h1 class="line">
                    Kompleksowe usługi <span>stomatologiczne</span>
                </h1>
                <h1 class="line">
                    Twoje <span>zdrowie</span> w dobrych rękach
                </h1>
            </div>
            <h2 class="line">{{pageTitle}}</h2>
            <ul class="pages-list">
                <li><a href="/">Duodent Bielany</a></li>
                <li><a href="/zabiegi-stomatologiczne-kompleksowa-oferta">Zabiegi</a></li>
                <li>{{pageTitle}}</li>
            </ul>
        </div>
    </div>
</div>
<!-- page banner end -->
<!-- breadcrumb start -->
<div id="breadcrumb-small" class="breadcrumb-small mb-5" style="display: none;">
    <div class="container justify-content-center">
        <div class="justify-content-center">
            <ul class="breadcrumb-pages-list">
                <li><a href="/"><i class="bi bi-houses-fill" style="font-size: 1rem;"></i></a></li>
                <li><a href="/zabiegi-stomatologiczne-kompleksowa-oferta">Zabiegi</a></li>
                <li>{{pageTitle}}</li>
            </ul>
        </div>
    </div>
</div>
<!-- breadcrumb end -->


    <!-- services-details-area -->
    <section class="services-details-area pb-100">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-6 mx-auto">
                    <div class="section-title-warp">
                        <span class="sub-title">
                            <i class="flaticon-hashtag-symbol"></i>
                            Usługi
                        </span>
                        <h2>{{pageTitle}}</h2>
                    </div>
                </div>
                {% if userName!='NotLogin' %}
                    <div id="baner-slogan-content" class="mb-30">
                        <div class="row">
                            <div
                                id="baner_h1_splx_line_1_part_1" data-editable data-type="text" 
                                class="col-lg-4 col-sm-12 p-2 fw-bold text-center fs-sm-4 fs-lg-2 text-dark-emphasis"
                                >
                                Tak wygląda
                            </div>
                            <div 
                                id="baner_h1_splx_line_1_part_2" data-editable data-type="text" 
                                class="col-lg-4 col-sm-12 p-2 fw-bold text-center fs-sm-4 fs-lg-2 text-info"
                                >
                                Edycja
                            </div>
                            <div 
                                id="baner_h1_splx_line_1_part_3" data-editable data-type="text" 
                                class="col-lg-4 col-sm-12 p-2 fw-bold text-center fs-sm-4 fs-lg-2 text-dark-emphasis"
                                >
                                sloganów na banerach
                            </div>
                        </div>
                        <div class="row">
                            <div
                                id="baner_h1_splx_line_2_part_1" data-editable data-type="text" 
                                class="col-lg-4 col-sm-12 p-2 fw-bold text-center fs-sm-4 fs-lg-2 text-dark-emphasis"
                                >
                                Poznaj naszych
                            </div>
                            <div 
                                id="baner_h1_splx_line_2_part_2" data-editable data-type="text" 
                                class="col-lg-4 col-sm-12 p-2 fw-bold text-center fs-sm-4 fs-lg-2 text-info"
                                >
                                wykwalifikowanych
                            </div>
                            <div 
                                id="baner_h1_splx_line_2_part_3" data-editable data-type="text" 
                                class="col-lg-4 col-sm-12 p-2 fw-bold text-center fs-sm-4 fs-lg-2 text-dark-emphasis"
                                >
                                specjalistów
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
            <div class="row">
                <div class="col-lg-8 col-md-12">
                    <div class="services-details-image">
                        <img 
                        src="{{url_for('static', filename='img/services/single-dziecieca.jpg')}}" 
                        alt="image"
                        {% if userName!='NotLogin' %}
                        id="foto_page_header_id" 
                        data-editable 
                        data-type="img"
                        {% endif %}
                        >
                    </div>
                    <div class="services-details-content">
                        <h3 
                            {% if userName!='NotLogin' %}id="page_title_section_1_id" data-editable data-type="text"{% endif %}
                            >Dental Implants</h3>
                        <p 
                            {% if userName!='NotLogin' %}id="page_content_section_1_id" data-editable data-type="text"{% endif %}
                            >Mauris dapibus arcu vitae dapibus laoreet. Duis vitae vestibulum sapien. Cras sed fermentum dui, a placerat lorem. Mauris quis justo consectetur, ullamcorper ante eget, porttitor arcu. Ut ac tellus id arcu mollis congue nec eget libero. Praesent quis pretium lacus. Sed fermentum ac magna id tempus. Phasellus bibendum commodo metus at suscipit. Sed eget nulla blandit, mattis libero non, tristique risus. Duis condimentum euismod nisi sed luctus. Cras posuere, felis eu euismod luctus, nulla nunc aliquet ante, nec mollis massa dolor a metus. Sed quis nibh eu leo fringilla rhoncus vitae porta mi. Sed eleifend neque vitae tempus placerat. Pellentesque vitae ipsum at orci ultrices tincidunt. Mauris tincidunt dolor et ante tincidunt maximus.
                        </p>
                    </div>
                    <div class="row">
                        {% if userName!='NotLogin' %}
                        <div class="col-lg-6 col-sm-12">
                            <div class="mb-3">
                                <label for="list-container_1" class="form-label">Twoja Lista</label>
                                <div id="list-container_1" class="no-border">
                                    <!-- Dynamicznie dodawane elementy -->
                                </div>
                                <div class="text-end mt-3">
                                    <button type="button" class="btn btn-warning btn-sm" onclick="addListItem('1', template, 'list-container_', 'Nowy element')">
                                        <i class="bi bi-plus-square-dotted"></i> Dodaj
                                    </button>
                                </div>
                            </div>
                            <button type="button" class="btn btn-success" onclick="exportList('1')">Eksportuj Listę</button>
                        </div>
                        <script>
                            // Wczytanie danych początkowych
                            document.addEventListener('DOMContentLoaded', () => {
                                const initialData = "Punkt 1#splx#Punkt 2#splx#Punkt 3";
                                addListFields(initialData, "1", "#splx#", template, "list-container_");
                                initializeSortable("list-container_1");
                            });
                        </script>
                        <div class="col-lg-6 col-sm-12">
                            <div class="mb-3">
                                <label for="list-container_2" class="form-label">Twoja Lista</label>
                                <div id="list-container_2" class="no-border">
                                    <!-- Dynamicznie dodawane elementy -->
                                </div>
                                <div class="text-end mt-3">
                                    <button type="button" class="btn btn-warning btn-sm" onclick="addListItem('2', template, 'list-container_', 'Nowy element')">
                                        <i class="bi bi-plus-square-dotted"></i> Dodaj
                                    </button>
                                </div>
                            </div>
                            <button type="button" class="btn btn-success" onclick="exportList('2')">Eksportuj Listę</button>
                        </div>

                        <script>
                            // Wczytanie danych początkowych
                            document.addEventListener('DOMContentLoaded', () => {
                                const initialData = "Punkt 4#splx#Punkt 5#splx#Punkt 6";
                                addListFields(initialData, "2", "#splx#", template, "list-container_");
                                initializeSortable("list-container_2");
                            });
                        </script>
                        {% else %}
                        <div class="col-lg-6 col-md-6">
                            <ul class="services-details-list">
                                <li>
                                    <i class="flaticon-check"></i>
                                    Praesent rhoncus varius pharetra.
                                </li>
                                <li>
                                    <i class="flaticon-check"></i>
                                    Ut hendrerit nisi eget urna vehicula rutrum.
                                </li>
                                <li>
                                    <i class="flaticon-check"></i>
                                    Nulla molestie bibendum blandit.
                                </li>
                            </ul>
                        </div>
                        <div class="col-lg-6 col-md-6">
                            <ul class="services-details-list">
                                <li>
                                    <i class="flaticon-check"></i>
                                    Pellentesque volutpat lacus metus.
                                </li>
                                <li>
                                    <i class="flaticon-check"></i>
                                    Ut porta odio volutpat nec
                                </li>
                                <li>
                                    <i class="flaticon-check"></i>
                                    Curabitur ultricies ex odio vitae facilisis
                                </li>
                            </ul>
                        </div>
                        {% endif %}
                    </div>
                    <p 
                        {% if userName!='NotLogin' %}id="page_subcontent_section_1_id" data-editable data-type="text"{% endif %}
                        >Praesent rhoncus varius pharetra. Ut hendrerit nisi eget urna vehicula rutrum. Nulla molestie bibendum blandit. Pellentesque volutpat lacus metus, ut porta odio volutpat nec. Curabitur ultricies ex odio, vitae facilisis sem volutpat nec. Nunc ultricies ut dui id interdum. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.
                    </p>
                    <div class="services-details-overview">
                        <div class="row">
                            <div class="col-lg-6 col-md-6">
                                <div class="single-gallery">
                                    <img 
                                        {% if userName!='NotLogin' %}
                                        id="page_photo_content_links_splx_section_2_f_1" 
                                        data-editable 
                                        data-type="img"
                                        {% endif %}
                                        src="../static/img/services/1.jpg" alt="image"
                                    >
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-6">
                                <div class="single-gallery">
                                    <img 
                                        {% if userName!='NotLogin' %}
                                        id="page_photo_content_links_splx_section_2_f_1" 
                                        data-editable 
                                        data-type="img"
                                        {% endif %}
                                        src="../static/img/services/1.jpg" alt="image"
                                    >
                                </div>
                            </div>
                        </div>
                    </div>
                    <p {% if userName!='NotLogin' %}id="page_subcontent_section_2_id" data-editable data-type="text"{% endif %}>
                        Pellentesque sit amet consequat ligula. Fusce interdum magna eget arcu hendrerit, non facilisis eros pharetra. Etiam ultricies sit amet nunc suscipit tristique. Proin lectus nisl, bibendum pellentesque arcu vel, faucibus sollicitudin urna. Nullam tempus leo sed magna viverra vehicula. Duis posuere sollicitudin libero eget volutpat. Ut nec interdum velit. Nullam sed nulla ac erat scelerisque semper id nec ante. Integer ac orci et metus sollicitudin varius. Duis imperdiet lectus et mi dictum, sed consequat neque blandit. Proin ac sodales lacus.
                    </p>
                    <div class="services-details-overview-content">
                        <h4 {% if userName!='NotLogin' %}id="page_title_section_3_id" data-editable data-type="text"{% endif %}>Praesent rhoncus varius : </h4>
                        <p {% if userName!='NotLogin' %}id="page_content_section_3_id" data-editable data-type="text"{% endif %}>
                            It is a long established fact that a reader will
                            be distracted by the readable content of a page when looking at its layout. The point of
                            psum is that it has a more or-less normal distribution of letters, as opposed to using.
                        </p>
                        <h4 {% if userName!='NotLogin' %}id="page_title_section_4_id" data-editable data-type="text"{% endif %}>
                            Odio rhoncus vulputate : 
                        </h4>
                        <p {% if userName!='NotLogin' %}id="page_content_section_4_id" data-editable data-type="text"{% endif %}>
                            Mauris eu massa eu odio rhoncus vulputate sed eget nunc. Mauris molestie, nulla quis vulputate sollicitudin, ipsum lacus ullamcorper felis, vitae tincidunt ante ex ac libero. Vivamus tincidunt consectetur ligula vel fermentum. Duis feugiat nisi euismod dui viverra, vel consectetur leo tincidunt. Donec lacinia, mauris sit amet congue vulputate, eros orci porttitor eros, at luctus tortor massa ut mi. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Pellentesque eu est ut mi porta sodales sit amet a risus.
                        </p>
                    </div>
                    {% if userName!='NotLogin' %}
                    <div class="row">
                        <div class="col-lg-8 col-sm-12">
                            <div class="mb-3">
                                <label for="list-container_3" class="form-label">Nazwa usługi</label>
                                <div id="list-container_3" class="no-border">
                                    <!-- Dynamicznie dodawane elementy -->
                                </div>
                                <div class="text-end mt-3">
                                    <button type="button" class="btn btn-warning btn-sm" onclick="addListItem('3', template, 'list-container_', 'Nowa usługa')">
                                        <i class="bi bi-plus-square-dotted"></i>
                                    </button>
                                </div>
                            </div>
                            <button type="button" class="btn btn-success" onclick="exportList('3')">Eksportuj Listę</button>
                        </div>
                        <script>
                            // Wczytanie danych początkowych
                            document.addEventListener('DOMContentLoaded', () => {
                                const initialData = "Punkt 1#splx#Punkt 2#splx#Punkt 3";
                                addListFields(initialData, "3", "#splx#", template, "list-container_");
                                initializeSortable("list-container_3");
                            });
                        </script>
                        <div class="col-lg-4 col-sm-12">
                            <div class="mb-3">
                                <label for="list-container_4" class="form-label">Cena</label>
                                <div id="list-container_4" class="no-border">
                                    <!-- Dynamicznie dodawane elementy -->
                                </div>
                                <div class="text-end mt-3">
                                    <button type="button" class="btn btn-warning btn-sm" onclick="addListItem('4', template, 'list-container_', 'Nowy element')">
                                        <i class="bi bi-plus-square-dotted"></i>
                                    </button>
                                </div>
                            </div>
                            <button type="button" class="btn btn-success" onclick="exportList('4')">Eksportuj Listę</button>
                        </div>

                        <script>
                            // Wczytanie danych początkowych
                            document.addEventListener('DOMContentLoaded', () => {
                                const initialData = "Punkt 4#splx#Punkt 5#splx#Punkt 6";
                                addListFields(initialData, "4", "#splx#", template, "list-container_");
                                initializeSortable("list-container_4");
                            });
                        </script>
                    </div>
                    {% else %}
                    <div class="card mt-5" style="width: 100%;">
                        <div class="card-header">
                            Featured
                          </div>
                          <ul class="list-group list-group-flush">
                              <li class="list-group-item">
                                  <div class="row">
                                      <div class="col-8">Wkład k/k od</div>
                                      <div class="col-4 border-start">od 190 zł</div>
                                  </div>
                              </li>
                              <li class="list-group-item">
                                  <div class="row">
                                      <div class="col-8">Wkład k/k od</div>
                                      <div class="col-4 border-start">od 190 zł</div>
                                  </div>
                              </li>
                              <li class="list-group-item">
                                  <div class="row">
                                      <div class="col-8">Wkład k/k od</div>
                                      <div class="col-4 border-start">od 190 zł</div>
                                  </div>
                              </li>
                              <li class="list-group-item">
                                  <div class="row">
                                      <div class="col-8">Wkład k/k od</div>
                                      <div class="col-4 border-start">od 190 zł</div>
                                  </div>
                              </li>
                          </ul>
                    </div>
                    {% endif %}
                        
                </div>
                <div class="col-lg-4 col-md-12">
                    <aside class="widget-area">
                        <div class="widget widget_info">
                            <div class="image">
                                <img src="../static/img/doctor/1.jpg" alt="image">
                            </div>
                            <div class="content">
                                <h3 
                                    id="element1" data-editable="true" data-type="picker" data-current-value="2"
                                    >Emma Brown</h3>
                                <p>Curabitur placerat mi id convallis dictum uis euismod urna sit amet purus congue</p>
                                <!-- <div class="share-link">
                                    <a href="#"><i class='bx bxl-facebook'></i></a>
                                    <a href="#"><i class='bx bxl-twitter'></i></a>
                                    <a href="#"><i class='bx bxl-linkedin'></i></a>
                                    <a href="#"><i class='bx bxl-instagram'></i></a>
                                </div> -->
                            </div>
                        </div>
                        <div class="widget widget_categories">
                            
                            <!-- <img src="../static/img/appointment/pani-1-lookup.jpg" alt="image"> -->
                             <div class="text-center">
                                 <i class="flaticon-emergency-call" style="font-size: 11rem;" onClick="window.location.href='tel:+48790777350'"></i>

                                <h3>
                                    Zadzwoń teraz 
                                    <span><a href="tel:+48790777350">790 777 350</a></span>
                                </h3>
                                <p>Potrzebujesz szybkiej konsultacji?</p>
                                <a href="/kontakt-z-przychodnia-stomatologiczna" class="default-btn">Kontakt</a>
                            </div>
                            
                        </div>
                        <div class="widget widget_tag_cloud">
                            <h3 class="widget-title">Szybki skrót</h3>
                            <div class="tagcloud">
                                <a href="/kontakt-z-przychodnia-stomatologiczna">Kontakt</a>
                                <a href="/informacje-dla-pacjentow-stomatologicznych">Dla Pacjenta</a>
                                <a href="/o-nas-twoja-przychodnia-stomatologiczna">Poznaj nas bliżej</a>
                                <a href="/umow-wizyte-online">Umów wizytę</a>
                            </div>
                        </div>
                        <div class="widget widget_grin_posts_thumb">
                            <h3 class="widget-title">Zabiegi</h3>
                            <article class="item">
                                <a href="/zabieg-stomatologiczny/protetyka-stomatologiczna-piekny-usmiech" class="thumb">
                                    {% set bg_image_protetyka =url_for('static', filename='img/services/protetyka-home.jpg') %}
                                    <span 
                                        class="fullimage" 
                                        style="background-image: url('{{ bg_image_protetyka }}');"
                                        role="img">
                                    </span>
                                </a>
                                <div class="info">
                                    <h5><a href="/zabieg-stomatologiczny/protetyka-stomatologiczna-piekny-usmiech"><i class="flaticon-chair"></i> Protetyka</a></h5>
                                    <span>
                                        Nowoczesne rozwiązania protetyczne!
                                    </span>
                                </div>
                            </article>
                            <article class="item">
                                <a href="/zabieg-stomatologiczny/chirurgia-implantologia-odbudowa-usmiechu" class="thumb">
                                    {% set bg_image_implantologia =url_for('static', filename='img/services/implantologia-home.jpg') %}
                                    <span 
                                        class="fullimage" 
                                        style="background-image: url('{{ bg_image_implantologia }}');"
                                        role="img">
                                    </span>
                                </a>
                                <div class="info">
                                    <h5><a href="/zabieg-stomatologiczny/chirurgia-implantologia-odbudowa-usmiechu"><i class="flaticon-dental-implant"></i> Implantologia</a></h5>
                                    <span>
                                        Odzyskaj wygodę i komfort jedzenia!
                                    </span>
                                </div>
                            </article>
                            <article class="item">
                                <a href="/zabieg-stomatologiczny/ortodoncja-aparaty-na-prosty-usmiech" class="thumb">
                                    {% set bg_image_ortodoncja =url_for('static', filename='img/services/ortodoncja-home.jpg') %}
                                    <span 
                                        class="fullimage" 
                                        style="background-image: url('{{ bg_image_ortodoncja }}');"
                                        role="img">
                                    </span>
                                </a>
                                <div class="info">
                                    <h5><a href="/zabieg-stomatologiczny/ortodoncja-aparaty-na-prosty-usmiech"><i class="flaticon-tooth"></i> Ortodoncja</a></h5>
                                    <span>
                                        Zadbaj o idealne ustawienie zębów!
                                    </span>
                                </div>
                            </article>
                        </div>
                        <div class="widget widget_categories">
                            <h3 class="widget-title">Przydatne pliki do pobrania</h3>
                            <div class="row mb-3">
                                <div class="col-2">
                                    <h1><i class="fas fa-download text-info"></i></h1>
                                </div>
                                <div class="col-10">
                                    <p class="fw-bold">
                                        <a href="/dokumenty/upowaznienie-do-samodzielnego-odbywania-wizyt-2024-788788.pdf">Upoważnienie do samodzielnego odbywania wizyt</a>
                                    </p>

                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-2">
                                    <h1><i class="fas fa-download text-info"></i></h1>
                                </div>
                                <div class="col-10">
                                    <p class="fw-bold">
                                        <a href="/dokumenty/karta-z-danymi-2024-2024-787740.pdf">Karta z danymi 2024</a>
                                    </p>

                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-2">
                                    <h1><i class="fas fa-download text-info"></i></h1>
                                </div>
                                <div class="col-10">
                                    <p class="fw-bold">
                                        <a href="/dokumenty/karta-z-danymi-2024-2024-787740.pdf">Karta z danymi 2024</a>
                                    </p>

                                </div>
                            </div>
                        </div>
                        <!-- <div class="widget widget_instagram">
                            <h3 class="widget-title">Gallery</h3>
                            <ul>
                                <li>
                                    <div class="box">
                                        <img src="../static/img/gallery/1.jpg" alt="image">
                                        <i class="bx bxl-instagram"></i>
                                        <a href="#" class="link-btn"></a>
                                    </div>
                                </li>
                                <li>
                                    <div class="box">
                                        <img src="../static/img/gallery/2.jpg" alt="image">
                                        <i class="bx bxl-instagram"></i>
                                        <a href="#" class="link-btn"></a>
                                    </div>
                                </li>
                                <li>
                                    <div class="box">
                                        <img src="../static/img/gallery/3.jpg" alt="image">
                                        <i class="bx bxl-instagram"></i>
                                        <a href="#" class="link-btn"></a>
                                    </div>
                                </li>
                                <li>
                                    <div class="box">
                                        <img src="../static/img/gallery/4.jpg" alt="image">
                                        <i class="bx bxl-instagram"></i>
                                        <a href="#" class="link-btn"></a>
                                    </div>
                                </li>
                                <li>
                                    <div class="box">
                                        <img src="../static/img/gallery/5.jpg" alt="image">
                                        <i class="bx bxl-instagram"></i>
                                        <a href="#" class="link-btn"></a>
                                    </div>
                                </li>
                                <li>
                                    <div class="box">
                                        <img src="../static/img/gallery/6.jpg" alt="image">
                                        <i class="bx bxl-instagram"></i>
                                        <a href="#" class="link-btn"></a>
                                    </div>
                                </li>
                            </ul>
                        </div> -->
                    </aside>
                </div>
            </div>
        </div>
    </section>
    <!-- services-details-area end -->

{% endblock %}
{% block bottom_scripts %}
<script>
    $(document).ready(function () {
        // Po 5 sekundach uruchom animację
        setTimeout(function () {
            // Animacja chowania #pageBanner
            $("#pageBanner").animate(
                {
                    height: "0px", // Zmień wysokość
                    marginBottom: "0px",
                    paddingTop: "0px", // Usuń górny padding
                    paddingBottom: "0px" // Usuń dolny padding
                },
                1000, // Czas animacji
                function () {
                    // Usunięcie wszystkich klas z #pageBanner po zakończeniu animacji
                    $("#pageBanner").empty().removeClass();

                    // Po zakończeniu animacji pokaż #breadcrumb-small
                    $("#breadcrumb-small")
                        .css({
                            display: "block", // Ustaw widoczność
                            textAlign: "center", // Wyrównanie tekstu do środka
                            width: "100%", // Rozciągnij na całą szerokość
                        })
                        .animate(
                            {
                                height: "50px",
                                paddingTop: "10px"
                            },
                            1200 // Czas animacji
                        );
                }
            );
        }, 5000); // Poczekaj 5 sekund przed uruchomieniem animacji
    });

    $(window).on('load', function () {
        let delay = 0;

        $('.line').each(function (index, element) {
            setTimeout(function () {
                $(element).addClass('animate');
            }, delay);

            delay += 500; // Opóźnienie dla kolejnej linii
        });
    });
    
</script>
{% if userName!='NotLogin' %}
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.14.0/Sortable.min.js"></script>
<script>

    function makeElementEditable(element) {
        const dataType = element.getAttribute('data-type');
        const elementId = element.getAttribute('id');

        if (dataType === 'img') {
            // Obsługa obrazka (bez zmian)
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = 'image/*';

            fileInput.addEventListener('change', () => {
                const file = fileInput.files[0];
                if (!file) return;

                const confirmUpload = confirm('Czy na pewno chcesz załadować to zdjęcie?');
                if (!confirmUpload) return;

                const formData = new FormData();
                formData.append('id', elementId);
                formData.append('type', dataType);
                formData.append('file', file);

                sendFileToBackend(formData, element);
            });

            fileInput.click();
        } else if (dataType === 'picker') {
            // Obsługa typu picker
            fetchPickerOptions(elementId)
                .then((options) => {
                    const selectElement = document.createElement('select');
                    selectElement.className = 'form-select'; // Bootstrap style (opcjonalnie)

                    // Dodanie opcji do selecta
                    options.forEach(({ id, description }) => {
                        const option = document.createElement('option');
                        option.value = id;
                        option.textContent = description;
                        selectElement.appendChild(option);
                    });

                    // Ustawienie początkowej wartości
                    const currentValue = element.getAttribute('data-current-value');
                    if (currentValue) {
                        selectElement.value = currentValue;
                    }

                    // Zamiana elementu na selecta
                    element.replaceWith(selectElement);

                    // Obsługa wyboru i wysyłki danych
                    selectElement.addEventListener('change', () => {
                        const selectedValue = selectElement.value;
                        sendDataToBackend(elementId, dataType, selectedValue);

                        // Zamiana selecta na oryginalny element z aktualizacją
                        element.textContent = options.find((opt) => opt.id == selectedValue).description;
                        element.setAttribute('data-current-value', selectedValue);
                        selectElement.replaceWith(element);
                    });
                })
                .catch((error) => {
                    console.error('Błąd wczytywania opcji:', error);
                });
        } else if (dataType === 'url') {
            // Otwartą logikę pozostawiamy na później
            console.log(`Logic for URL is not yet implemented for element ${elementId}.`);
            alert('Obsługa URL jest w trakcie wdrażania. Spróbuj później.');
        } else {
            // Obsługa innych typów danych
            element.setAttribute('contenteditable', 'true');
            element.focus();
            element.style.border = '2px dashed #007bff';

            element.addEventListener(
                'blur',
                () => {
                    element.setAttribute('contenteditable', 'false');
                    element.style.border = 'none';

                    const updatedValue = element.innerText.trim();
                    if (!validateInput(updatedValue, dataType)) {
                        alert('Nieprawidłowa wartość!');
                        return;
                    }

                    const processedValue = processDataType(dataType, updatedValue);
                    sendDataToBackend(elementId, dataType, processedValue);
                },
                { once: true }
            );
        }
    }

    // function makeElementEditable(element) {
    //     const dataType = element.getAttribute('data-type');
    //     const elementId = element.getAttribute('id');

    //     if (dataType === 'img') {
    //         // Obsługa obrazka
    //         const fileInput = document.createElement('input');
    //         fileInput.type = 'file';
    //         fileInput.accept = 'image/*'; // Akceptuj tylko obrazy

    //         fileInput.addEventListener('change', () => {
    //             const file = fileInput.files[0];
    //             if (!file) return;

    //             // Wyświetl potwierdzenie przed wysłaniem
    //             const confirmUpload = confirm('Czy na pewno chcesz załadować to zdjęcie?');
    //             if (!confirmUpload) return;

    //             // Przygotowanie danych do wysłania
    //             const formData = new FormData();
    //             formData.append('id', elementId);
    //             formData.append('type', dataType);
    //             formData.append('file', file);

    //             // Wysyłanie danych do backendu
    //             sendFileToBackend(formData, element);
    //         });

    //         // Kliknięcie w input (otwiera okno wyboru pliku)
    //         fileInput.click();
    //     } else {
    //         // Obsługa innych typów danych
    //         element.setAttribute('contenteditable', 'true');
    //         element.focus();
    //         element.style.border = '2px dashed #007bff';

    //         element.addEventListener(
    //             'blur',
    //             () => {
    //                 element.setAttribute('contenteditable', 'false');
    //                 element.style.border = 'none';

    //                 const updatedValue = element.innerText.trim();
    //                 if (!validateInput(updatedValue, dataType)) {
    //                     alert('Nieprawidłowa wartość!');
    //                     return;
    //                 }

    //                 const processedValue = processDataType(dataType, updatedValue);
    //                 sendDataToBackend(elementId, dataType, processedValue);
    //             },
    //             { once: true }
    //         );
    //     }
    // }

    function fetchPickerOptions(elementId) {
        return new Promise((resolve, reject) => {
            $.ajax({
                url: '/admin/get-picker-options',
                type: 'GET',
                data: { id: elementId },
                success: (response) => {
                    if (response.options) {
                        resolve(response.options); // Zakładamy, że backend zwraca listę obiektów { id, description }
                    } else {
                        reject('Brak opcji w odpowiedzi.');
                    }
                },
                error: (xhr) => {
                    reject('Błąd wczytywania opcji: ' + xhr.responseJSON.error);
                }
            });
        });
    }

    // Funkcja walidacji podstawowej
    function validateInput(value, dataType) {
        switch (dataType) {
            case 'text':
                return value.length > 0;
            case 'picker':
                return !isNaN(parseInt(value));
            case 'img':
            case 'url':
                return value.startsWith('http');
            default:
                return true;
        }
    }

    // Funkcja przetwarzania danych
    function processDataType(dataType, value) {
        switch (dataType) {
            case 'text':
                return value;
            case 'picker':
                return parseInt(value);
            case 'img':
            case 'url':
                return value;
            default:
                return value;
        }
    }

    // Funkcja do wysyłania danych do backendu
    function sendDataToBackend(id, type, value) {
        $.ajax({
            url: '/admin/edytuj-wybrany-element',
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify({ id, type, value }),
            success: (response) => {
                console.log('Zaktualizowano:', response.message);
            },
            error: (xhr) => {
                console.error('Błąd aktualizacji:', xhr.responseJSON.error);
            }
        });
    }

    // Funkcja do przesyłania plików do backendu
    function sendFileToBackend(formData, element) {
        $.ajax({
            url: '/admin/edytuj-wybrany-element',
            type: 'POST',
            processData: false, // Ważne przy używaniu FormData
            contentType: false,
            data: formData,
            success: (response) => {
                console.log('Zdjęcie zaktualizowano:', response.message);

                // Opcjonalnie: Ustaw nowe zdjęcie w elemencie
                const newImageUrl = response.newImageUrl; // URL zwracany przez backend
                if (newImageUrl) {
                    element.src = newImageUrl;
                }
            },
            error: (xhr) => {
                console.error('Błąd podczas aktualizacji zdjęcia:', xhr.responseJSON.error);
            }
        });
    }

    function initializeEditableElements() {
        const editableElements = document.querySelectorAll('[data-editable]');
        editableElements.forEach((element) => {
            if (!element.hasAttribute('data-initialized')) { // Unikamy dodawania eventów dwa razy
                element.addEventListener('dblclick', () => makeElementEditable(element));
                element.setAttribute('data-initialized', 'true');
            }
        });
    }

    document.addEventListener('DOMContentLoaded', initializeEditableElements);


    // // //  // // //  //      //        //
    //        //    //  //        //   //
    // // //  // // //  //          //
          //  //        //        //  //
    // // //  //        // //  //       //


    // // // SPLX 
    //   
    // // // Logika dynamicznej listy z edytowalnymi polami // // //
    //   
    // // // Funkcje do dodawania, usuwania, sortowania i eksportu danych // // //

    // SPLX V 2.0
    // Szablon elementu listy
    const template = `
            <div class="item-container d-flex align-items-center mb-2">
                <div class="drag-handle me-2">
                    <i class="bi bi-grip-vertical" style="cursor: grab;"></i>
                </div>
                <div class="editable-content flex-grow-1 p-2 fs-6 bg-light text-dark" contenteditable="true">
                    &^^idemDiv&^^
                </div>
                <button type="button" class="remove-btn btn btn-outline-danger ms-2" style="max-heigh: 25px; max-with: 25px;">
                    <i class="bi bi-trash3-fill" style="font-size: 13px;"></i>
                </button>
            </div>
        `;

        // Funkcja do wczytywania elementów z danych
        function addListFields(data, id, sep, template, containerID) {
            const container = document.getElementById(containerID + id);
            if (!container) {
                console.error(`Container with ID ${containerID + id} does not exist.`);
                return;
            }

            const html = data.split(sep)
                .map(value => template.replace("&^^idemDiv&^^", value))
                .join("");

            container.innerHTML += html;
        }

        // Funkcja do dodawania nowego elementu
        function addListItem(id, template, containerID, defaultValue = "") {
            const container = document.getElementById(containerID + id);
            if (!container) {
                console.error(`Container with ID ${containerID + id} does not exist.`);
                return;
            }

            container.insertAdjacentHTML(
                'beforeend',
                template.replace("&^^idemDiv&^^", defaultValue)
            );
        }

        // Funkcja do eksportu danych
        function joinListFields(containerID, separator = "#splx#") {
            const container = document.getElementById(containerID);
            if (!container) {
                console.error(`Container with ID ${containerID} does not exist.`);
                return "";
            }

            const items = Array.from(container.querySelectorAll(".editable-content"));

            const processedItems = items.map((item) => {
                return item.innerText.replace(/\s+/g, " ").trim();
            });

            return processedItems.join(separator);
        }

        // Funkcja eksportu wywoływana z przycisku
        function exportList(id) {
            const exportedData = joinListFields(`list-container_${id}`, "#splx#");
            console.log("Eksportowane dane:", exportedData);
            alert("Eksportowane dane:\n" + exportedData);
        }

        // Inicjalizacja SortableJS
        function initializeSortable(containerID) {
            const container = document.getElementById(containerID);
            if (!container) {
                console.error(`Container with ID ${containerID} does not exist.`);
                return;
            }

            new Sortable(container, {
                animation: 150,
                ghostClass: "sortable-ghost",
                onEnd: function (evt) {
                    console.log(`Element przeniesiony z pozycji ${evt.oldIndex} na pozycję ${evt.newIndex}`);
                }
            });
        }

        // Obsługa usuwania elementów
        document.addEventListener("click", function (e) {
            if (e.target && e.target.closest(".remove-btn")) {
                const item = e.target.closest(".item-container");
                if (item) item.remove();
            }
        });
    
</script>
{% endif %}
    
{% endblock %}
