{% extends 'base.html' %}
{% block content %}
<!-- page banner -->
{% set bg_image_online_visit = url_for('static', filename='img/banners/wizytaonline-4-banner.jpg') %}
<div class="page-banner-area mb-5" id="pageBanner" style="background-image: url('{{ bg_image_online_visit }}');">
    <div class="container">
        <div class="page-banner-content">
            <div class="page-banner-content">
                <h1 class="line">
                    Umów <span>wizytę</span> online
                </h1>
                <h1 class="line">
                    Komfortowa <span>rezerwacja</span> w kilka chwil
                </h1>
            </div>
            <h2 class="line">{{pageTitle}}</h2>
            <ul class="pages-list line">
                <li><a href="/">Duodent Bielany</a></li>
                <li>{{pageTitle}}</li>
            </ul>
        </div>
    </div>
</div>
<!-- page banner end -->
<!-- breadcrumb start -->
<div id="breadcrumb-small" class="breadcrumb-small mb-5" style="display: none;">
    <div class="container justify-content-center">
        <div class="justify-content-center">
            <ul class="breadcrumb-pages-list">
                <li><a href="/">Duodent Bielany</a></li>
                <li>{{pageTitle}}</li>
            </ul>
        </div>
    </div>
</div>
<!-- breadcrumb end -->
 <!-- emergency call -->
 <section class="overview-area">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <div class="overview-content">
                    <span class="sub-title">
                        <i class="flaticon-hashtag-symbol"></i>
                        Zadzwoń do nas
                    </span>
                    <h3>Masz nagły<span> problem?</span> Jesteśmy tu, by Ci pomóc!</h3>
                    <p><a href="tel:+48790777350">Zadzwoń teraz: <i class="far fa-phone"></i> +48 790 777 350</a></p>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="overview-image">
                    <img src="static/img/emergency-1-pan-doktor.png" alt="image">
                </div>
            </div>
        </div>
    </div>
</section>
<!-- emergency call end -->


<!-- appointment -->
<section class="appointment-overview-area pb-100">
    <div class="container">
        <div class="row">
            <div class="col-lg-4 col-md-12">
                <div class="appointment-overview-contact">
                    <img src="static/img/appointment/pani-1-lookup.jpg" alt="image">
                    <div class="appointment-info">
                        <ul class="call-info">
                            <li>
                                <i class="flaticon-emergency-call" onClick="window.location.href='tel:+48790777350'"></i>
                                Zadzwoń teraz:
                                <span><a href="tel:+48790777350">790 777 350</a></span>
                            </li>
                        </ul>
                        <p>Potrzebujesz szybkiej konsultacji?</p>
                        <a href="/kontakt-z-przychodnia-stomatologiczna" class="default-btn">Kontakt</a>
                    </div>
                </div>
            </div>
            <div class="col-lg-8">
                <div class="appointment-overview-box">
                    <div class="make-appointment-content">
                        <h4><i class="far fa-calendar-alt"></i> Umów wizytę</h4>
                        <form id="appointmentForm">

                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label>Imię i Nazwisko</label>
                                        <input type="text" class="form-control" id="name" name="name" required placeholder="Imię i Nazwisko">
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label>Email</label>
                                        <input type="text" class="form-control" id="email" name="email" required placeholder="Email">
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label>Telefon</label>
                                        <input type="text" class="form-control" id="phone" name="phone" required placeholder="Telefon" >
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-seclect-clear">
                                        <div class="form-floating">
                                            <select id="patient_type" name="patient_type" class="form-select" aria-label="Pacjent" required>
                                                <option selected>Wiek Pacjenta</option>
                                                <option value="adult">Dorosły</option>
                                                <option value="child">Dziecko</option>
                                            </select>
                                            <label for="patient_type">Pacjent</label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label>Data wizyty</label>
                                        <input type="date" id="visit_date" name="visit_date" required class="form-control">
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <p style="font-size: 14px; color: #6b6b6b;">
                                        Ten formularz nie gwarantuje umówienia terminu. Uruchamia jedynie proces rejestracji, 
                                        a recepcja placówki skontaktuje się z Państwem w celu dopełnienia niezbędnych formalności, 
                                        m.in. ustalenia godziny wizyty we wskazanym dniu.
                                    </p>
                                </div>
                            </div>
                            <div class="form-check form-switch mb-3">
                                <input class="form-check-input" type="checkbox" role="switch" id="consent" name="consent" required>
                                <label class="form-check-label" for="consent" style="font-size: 10px; color:#acacac">
                                    Wyrażam zgodę na <strong style="color:#243f3f;">przetwarzanie</strong> moich <strong style="color:#243f3f;">danych osobowych</strong> przez Duodent Bielany 
                                    <strong style="color:#243f3f;">w celu rejestracji wizyty i kontaktu</strong>, zgodnie z obowiązującymi przepisami
                                    Rozporządzenia Parlamentu Europejskiego i Rady (UE) 2016/679 z dnia 27 
                                    kwietnia 2016 r. <strong style="color:#243f3f;">(RODO)</strong>.
                                </label>
                            </div>
                            <button type="submit" class="default-btn">Wyslij wniosek</button>
                            <div id="responseMessage" style="margin-top: 20px;"></div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- appointment end -->

{% endblock %}
{% block bottom_scripts %}
    <script>
        $(document).ready(function () {
            $('#appointmentForm').on('submit', function (event) {
                event.preventDefault(); // Zapobiegamy standardowemu przesłaniu formularza

                const formData = {
                    name: $('#name').val(),
                    email: $('#email').val(),
                    phone: $('#phone').val(),
                    patient_type: $('#patient_type').val(), // Nowe pole
                    visit_date: $('#visit_date').val(),
                    consent: $('#consent').is(':checked')
                };

                // Wysyłamy dane przez AJAX
                $.ajax({
                    url: '/api/umow-wizyte',
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify(formData),
                    success: function (response) {
                        $('#responseMessage').html(`<p>${response.message}</p>`);
                        $('#appointmentForm')[0].reset(); // Czyścimy formularz
                    },
                    error: function (error) {
                        $('#responseMessage').html(`<p style="color: red;">Błąd: ${error.responseJSON.message}</p>`);
                    }
                });
            });
        });

        $(document).ready(function () {
            // Po 5 sekundach uruchom animację
            setTimeout(function () {
                // Animacja chowania #pageBanner
                $("#pageBanner").animate(
                    {
                        height: "0px", // Zmień wysokość
                        marginBottom: "0px",
                        paddingTop: "0px", // Usuń górny padding
                        paddingBottom: "0px" // Usuń dolny padding
                    },
                    1000, // Czas animacji
                    function () {
                        // Usunięcie wszystkich klas z #pageBanner po zakończeniu animacji
                        $("#pageBanner").empty().removeClass();

                        // Po zakończeniu animacji pokaż #breadcrumb-small
                        $("#breadcrumb-small")
                            .css({
                                display: "block", // Ustaw widoczność
                                textAlign: "center", // Wyrównanie tekstu do środka
                                width: "100%", // Rozciągnij na całą szerokość
                            })
                            .animate(
                                {
                                    height: "50px",
                                    paddingTop: "10px"
                                },
                                1200 // Czas animacji
                            );
                    }
                );
            }, 5000); // Poczekaj 5 sekund przed uruchomieniem animacji
        });

        $(window).on('load', function () {
            let delay = 0;

            $('.line').each(function (index, element) {
                setTimeout(function () {
                    $(element).addClass('animate');
                }, delay);

                delay += 500; // Opóźnienie dla kolejnej linii
            });
        });
    </script>
{% endblock %}